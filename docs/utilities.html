<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Atomik Framework</title>
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Sans&subset=latin">
    <link type="text/css" rel="stylesheet" href="/docs/css/reset.css">
    <link type="text/css" rel="stylesheet" href="/docs/css/docs.css">
    <link type="text/css" rel="stylesheet" href="/docs/css/print.css" media="print">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/sunburst.min.css">
    
        <link type="text/css" rel="stylesheet" href="style.css">
    
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    
    <script type="text/javascript" src="/docs/js/viewer.js"></script>
</head>
<body>
    <div id="page">
        <a name="top" />
        
            <header id="header">
                <h1><a href="/docs/">Atomik Framework</a></h1>
            </header>
        
        


    <div id="sidebar">
        <nav id="toc">
            
    <ol>
    
        <li>
            <a href="/docs/introduction.html#introduction">Introduction</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/introduction.html#requirements">Requirements</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#installation">Installation</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#directory-structure">Directory structure</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#advanced-installation">Advanced installation</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/get-started.html#get-started">Get started</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/get-started.html#the-database">The database</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#listing-posts">Listing posts</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#creating-new-posts">Creating new posts</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#viewing-a-post">Viewing a post</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/global-store.html#the-global-store">The global store</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/global-store.html#accessing-the-store">Accessing the store</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#nested-arrays">Nested arrays</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#accessing-the-global-store-from-actions-and-views">Accessing the global store from actions and views</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#using-accessors-with-any-array">Using accessors with any array</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/configuration.html#configuration">Configuration</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/configuration.html#configuration-file">Configuration file</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#bootsrapping">Bootsrapping</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#custom-directory-structure">Custom directory structure</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#pre-and-post-dispatch-files">Pre and post dispatch files</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/urls.html#urls">URLs</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/urls.html#calling-an-action">Calling an action</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#routing-urls">Routing urls</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#file-extensions">File extensions</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#building-urls">Building urls</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/actions.html#actions">Actions</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/actions.html#introduction">Introduction</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#action-files">Action files</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#actions-and-http-methods">Actions and HTTP methods</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#redirections-and-404-errors">Redirections and 404 errors</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#includes">Includes</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#calling-actions-programmatically">Calling actions programmatically</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/views.html#views">Views</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/views.html#views">Views</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#layout">Layout</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#view-contexts">View contexts</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#controlling-views">Controlling views</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#rendering-views-programmatically">Rendering views programmatically</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/helpers.html#helpers">Helpers</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/helpers.html#creating-helpers">Creating helpers</a>
            
        </li>
    
        <li>
            <a href="/docs/helpers.html#using-helpers">Using helpers</a>
            
        </li>
    
        <li>
            <a href="/docs/helpers.html#registering-helpers"> Registering helpers</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/utilities.html#utilities">Utilities</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/utilities.html#escaping-text">Escaping text</a>
            
        </li>
    
        <li>
            <a href="/docs/utilities.html#friendly-urls">Friendly urls</a>
            
        </li>
    
        <li>
            <a href="/docs/utilities.html#filtering-and-validating-data">Filtering and validating data</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#using-plugins">Using plugins</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/using-plugins.html#installing-a-plugin">Installing a plugin</a>
            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#activating-and-configuring-a-plugin">Activating and configuring a plugin</a>
            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#pluggable-applications">Pluggable applications</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/session.html#session">Session</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/session.html#starting-and-accessing-the-session">Starting and accessing the session</a>
            
        </li>
    
        <li>
            <a href="/docs/session.html#flash-messages">Flash messages</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#error-handling-logging-and-debugging">Error handling, logging and debugging</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/error-log-debug.html#handling-errors">Handling errors</a>
            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#logging">Logging</a>
            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#debugging">Debugging</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/database.html#database">Database</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/database.html#connecting">Connecting</a>
            
        </li>
    
        <li>
            <a href="/docs/database.html#querying-data">Querying data</a>
            
        </li>
    
        <li>
            <a href="/docs/database.html#manipulating-data">Manipulating data</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/scripts.html#scripts">Scripts</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/scripts.html#creating-custom-scripts">Creating custom scripts</a>
            
        </li>
    
        <li>
            <a href="/docs/scripts.html#registering-commands">Registering commands</a>
            
        </li>
    
        <li>
            <a href="/docs/scripts.html#built-in-commands">Built-in commands</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/translations.html#translations">Translations</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/translations.html#creating-language-files">Creating language files</a>
            
        </li>
    
        <li>
            <a href="/docs/translations.html#detecting-the-user-language">Detecting the user language</a>
            
        </li>
    
        <li>
            <a href="/docs/translations.html#translating-strings">Translating strings</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/controllers.html#controller">Controller</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/controllers.html#differences-with-the-classic-atomik-way">Differences with the classic Atomik way</a>
            
        </li>
    
        <li>
            <a href="/docs/controllers.html#creating-controllers">Creating controllers</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/events.html#events">Events</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/events.html#listening-to-events">Listening to events</a>
            
        </li>
    
        <li>
            <a href="/docs/events.html#firing-events">Firing events</a>
            
        </li>
    
        <li>
            <a href="/docs/events.html#events-naming-convention">Events naming convention</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#developing-plugins">Developing plugins</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/developing-plugins.html#the-plugin-file">The plugin file</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#configuration">Configuration</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#using-a-class">Using a class</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#pluggable-applications">Pluggable applications</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#assets-and-urls">Assets and urls</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#loading-plugins-programmaticaly">Loading plugins programmaticaly</a>
            
        </li>
    
</ol>

            
        </li>
    
</ol>

        </nav>
    </div>

<article id="content">
    <a name="utilities"></a><h1>Utilities</h1>
<p>All these utilities are helpers bundled with Atomik.

</p>
<a name="escaping-text"></a><h2>Escaping text</h2>
<p>It is a common (and very good) practice to escape data when outputting it on the page.
The <code>escape()</code> helper is dedicated to this purpose.

</p>
<pre><code>echo $this-&gt;escape(&#39;my text&#39;);</code></pre>
<p>This helper relies on other functions to escape data. It simply executes them one after an other 
and returns the result. You can for example, execute the <code>htmlspecialchars()</code> function followed by <code>nl2br()</code>.

</p>
<p>The functions to execute are grouped under profiles. Thus, you can create multiple escaping profiles 
depending on the data you need to escape. Profiles are defined in the <em>app.escaping</em> 
configuration key. To specify which functions to execute in a profile, you can use a string or an 
array of strings. Functions will be executed in the order they appear in the array.
The default profile is called <em>default</em>.

</p>
<p>The profile is specified as the last argument of the method.

</p>
<pre><code>// creating profiles
Atomik::set(&#39;app.escaping&#39;, array(
    &#39;default&#39; =&gt; array(&#39;htmlspecialchars&#39;, &#39;nl2br&#39;),
    &#39;url&#39; =&gt; &#39;urlencode&#39;
));

// equivalent of nl2br(htmlspecialchars(&#39;my text&#39;))
echo $this-&gt;escape(&#39;my text&#39;);

// equivalent of urlencode(&#39;my url param&#39;)
echo $this-&gt;escape(&#39;my url param&#39;, &#39;url&#39;);</code></pre>
<a name="friendly-urls"></a><h2>Friendly urls</h2>
<p>Having a router without a way to make friendly urls wouldn&#39;t be a complete feature. 
The <code>linkify()</code> helper transforms any string to a url friendly version.

</p>
<pre><code>echo $this-&gt;friendlify(&#39;My text in the url&#39;);
// will echo my-text-in-the-url</code></pre>
<a name="filtering-and-validating-data"></a><h2>Filtering and validating data</h2>
<p>Filtering and validating user input is a very important task and Atomik had to provide a helper for
this purpose. This helper is <em>filter()</em> and it heavily relies on PHP&#39;s filter extension.

</p>
<p>PHP&#39;s filter extension is built-in since version 5.2 and its documentation is available 
at <a href="http://php.net/filter">http://php.net/filter</a>.

</p>
<p>You can find a good documentation (better than the official one) about available filters on the w3schools
website at <a href="http://www.w3schools.com/php/php_ref_filter.asp">http://www.w3schools.com/php/php_ref_filter.asp</a>

</p>
<p>To understand and use <code>filter()</code> you must know how to use PHP&#39;s filter
extension. However, Atomik&#39;s method adds some features.

</p>
<p><code>filter()</code> has the same arguments as <code>filter_var()</code>.
However, you can also use a regular expression as filter in the second argument. The regexp must use
slashes as delimiters. You can also define custom filters in the <em>app.filters.callbacks</em>
configuration key and use the callback name as filter.

</p>
<pre><code>// using a php filter
$result = $this-&gt;filter(&#39;me@example.com&#39;, FILTER_VALIDATE_EMAIL);
$result = $this-&gt;filter(&#39;me@example.com&#39;, &#39;validate_email&#39;); // using the filter name instead of its id
$result = $this-&gt;filter(&#39;example.com&#39;, FILTER_VALIDATE_URL, FILTER_FLAG_SCHEME_REQUIRED);

// using a regexp
$result = $this-&gt;filter(&#39;12478&#39;, &#39;/\d+/&#39;);

// using a callback
Atomik::set(&#39;app.filters.callbacks.my_custom_filter&#39;, &#39;myFilterFunction&#39;);
$result = $this-&gt;filter($data, &#39;my_custom_filter&#39;);</code></pre>
<p>It will return false if an error occured, or the value otherwise.

</p>
<p>The method can also be used to filter arrays in the same way as <code>filter_var_array()</code>. It works
exactly the same as this function but it also adds more features.

</p>
<p>The method will return false if any of the item failed to validate. This can be turned off by passing
false as the fourth argument.

</p>
<p>While the second argument is named a definition in the PHP&#39;s extension, Atomik called it rules. 
Rules are arrays where keys are field&#39;s name and their value a filter or an array 
(like with ̀filter_var_array()`). You can pass a rule as the second argument. 
Rules can also be defined in the <em>app.filters.rules</em> configuration key. 
You can then use their name instead of an array as the second argument.

</p>
<p>The method also adds the notion of required fields. If you set the <em>required</em> key to true in 
the field&#39;s array, the validation will fail if the field is missing or empty. 

</p>
<p>When a field is empty but not required, its value will be null. This can be changed by setting 
the <em>default</em> key in the field&#39;s array.

</p>
<p>The <em>filter</em> key in the field&#39;s array follows the same rule as the filter parameter described previously. 
Thus it can be a filter&#39;s id or name, a regexp or a custom filter&#39;s name.

</p>
<p>The helper also supports multi-dimension array as input.

</p>
<p>Finally, support for validation messages has also been added. When filtering the array, if any values 
failed validating, a message will be created. Messages can then be retreived in the 
<em>app.filters.messages</em> configuration key. There ar two default messages configured in 
<em>app.filters.default_message</em> and <em>app.filters.required_message</em>.
The former will be used when a field failed to validate while the later when the required condition has not been met.

</p>
<p>When setting the two message keys, you can use <em>%s</em> which will be replaced with the field&#39;s name. 
As field names aren&#39;t usually pretty, you can use the <em>label</em> key in the field&#39;s array to define 
the text which will be used to replace <em>%s</em>.

</p>
<p>You can override the failed to validate message for each field by setting the <em>message</em> 
key in the field&#39;s array.

</p>
<pre><code>// using a custom message when a field is missing or empty
Atomik::set(&#39;app.filters.required_message&#39;, &#39;You forgot to fill the %s field!&#39;);

// the data to validate
$dataToFilter = array(
    &#39;username&#39; =&gt; &#39;peter&#39;,
    &#39;email&#39; =&gt; &#39;peter@example.com&#39;
);

// our rules
$fields = array(
    &#39;username&#39; =&gt; array(
        &#39;filter&#39; =&gt; FILTER_SANITIZE_STRING,
        &#39;required&#39; =&gt; true
    ),
    &#39;email&#39; =&gt; array(
        &#39;filter&#39; =&gt; &#39;validate_email&#39;,
        &#39;required&#39; =&gt; true,
        &#39;message&#39; =&gt; &#39;You must provide a valid email address&#39; // custom message when the field failed to validate
    )
);

if (($filteredData = $this-&gt;filter($dataToFilter, $fields)) === false) {
    // failed validation, showing messages
    Atomik::flash(A(&#39;app.filters.messages&#39;), &#39;error&#39;);
    return;
}

// success
// do something with $filteredData</code></pre>

</article>

        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a> - <a href="/docs/all.html">Everything on a single page</a>
            - <a href="?print=1">Print current page</a> - <a href="/docs/all.html?print=1">Print all pages</a>
            
        </footer>
    </div>
</body>
</html>
